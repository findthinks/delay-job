var xe=Object.defineProperty,Ce=Object.defineProperties;var Ee=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var P=Math.pow,Z=(a,e,t)=>e in a?xe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,k=(a,e)=>{for(var t in e||(e={}))Se.call(e,t)&&Z(a,t,e[t]);if(K)for(var t of K(e))Te.call(e,t)&&Z(a,t,e[t]);return a},C=(a,e)=>Ce(a,Ee(e));import{a as H,a7 as we,a$ as Ie,af as f,cn as X,dk as B,ag as le,b8 as V,_ as v,W as U,N as w,p as I,X as Y,T as J,aB as Ae,al as De,b3 as _e,I as Pe,bd as $,w as Oe,b as je,f as $e,j as R,aa as Re,Z as Le,ar as Ne,at as Ge,o as Q,i as Be,k as Ve,av as Ue,aw as Ye,B as We,ax as Fe,ay as He,az as qe,au as ze,l as Ke,n as ee,r as L,aA as Ze}from"./index.c6cd9d59.js";var Xe=globalThis&&globalThis.__rest||function(a,e){var t={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(a);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(a,s[n])&&(t[s[n]]=a[s[n]]);return t},Je=H({name:"Checkbox",mixins:[we],inheritAttrs:!1,props:Ie({prefixCls:f.string,name:f.string,id:f.string,type:f.string,defaultChecked:X(f.oneOfType([f.number,f.looseBool])),checked:X(f.oneOfType([f.number,f.looseBool])),disabled:f.looseBool,tabindex:f.oneOfType([f.string,f.number]),readonly:f.looseBool,autofocus:f.looseBool,value:f.any},{prefixCls:"rc-checkbox",type:"checkbox",defaultChecked:!1}),data:function(){var e=B(this,"checked")?this.checked:this.defaultChecked;return{sChecked:e}},watch:{checked:function(e){this.sChecked=e}},mounted:function(){le(function(){})},methods:{focus:function(){this.$refs.input.focus()},blur:function(){this.$refs.input.blur()},handleChange:function(e){var t=V(this);if(!t.disabled){"checked"in t||(this.sChecked=e.target.checked),e.shiftKey=this.eventShiftKey;var s={target:v(v({},t),{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e};"checked"in t&&(this.$refs.input.checked=t.checked),this.__emit("change",s),this.eventShiftKey=!1}},onClick:function(e){this.__emit("click",e),this.eventShiftKey=e.shiftKey}},render:function(){var e,t=V(this),s=t.prefixCls,n=t.name,r=t.id,o=t.type,i=t.disabled,c=t.readonly,u=t.tabindex,d=t.autofocus,h=t.value,g=Xe(t,["prefixCls","name","id","type","disabled","readonly","tabindex","autofocus","value"]),p=this.$attrs,y=p.class,S=p.onFocus,D=p.onBlur,_=Object.keys(v(v({},g),this.$attrs)).reduce(function(O,x){return(x.substr(0,5)==="aria-"||x.substr(0,5)==="data-"||x==="role")&&(O[x]=g[x]),O},{}),M=this.sChecked,m=U(s,y,(e={},w(e,"".concat(s,"-checked"),M),w(e,"".concat(s,"-disabled"),i),e)),T=v(v({name:n,id:r,type:o,readonly:c,disabled:i,tabindex:u,class:"".concat(s,"-input"),checked:!!M,autofocus:d,value:h},_),{onChange:this.handleChange,onClick:this.onClick,onFocus:S,onBlur:D});return I("span",{class:m},[I("input",Y({ref:"input"},T),null),I("span",{class:"".concat(s,"-inner")},null)])}}),te=globalThis&&globalThis.__rest||function(a,e){var t={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(a);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(a,s[n])&&(t[s[n]]=a[s[n]]);return t};function se(){}var cs=H({name:"ACheckbox",inheritAttrs:!1,__ANT_CHECKBOX:!0,props:{prefixCls:f.string,defaultChecked:f.looseBool,checked:f.looseBool,disabled:f.looseBool,isGroup:f.looseBool,value:f.any,name:f.string,id:f.string,indeterminate:f.looseBool,type:f.string.def("checkbox"),autofocus:f.looseBool,onChange:f.func,"onUpdate:checked":f.func},emits:["change","update:checked"],setup:function(){return{configProvider:J("configProvider",Ae),checkboxGroupContext:J("checkboxGroupContext",void 0)}},watch:{value:function(e,t){var s=this;le(function(){var n=s.checkboxGroupContext,r=n===void 0?{}:n;r.registerValue&&r.cancelValue&&(r.cancelValue(t),r.registerValue(e))})}},mounted:function(){var e=this.value,t=this.checkboxGroupContext,s=t===void 0?{}:t;s.registerValue&&s.registerValue(e),De(B(this,"checked")||this.checkboxGroupContext||!B(this,"value"),"Checkbox","`value` is not validate prop, do you mean `checked`?")},beforeUnmount:function(){var e=this.value,t=this.checkboxGroupContext,s=t===void 0?{}:t;s.cancelValue&&s.cancelValue(e)},methods:{handleChange:function(e){var t=e.target.checked;this.$emit("update:checked",t),this.$emit("change",e)},focus:function(){this.$refs.vcCheckbox.focus()},blur:function(){this.$refs.vcCheckbox.blur()}},render:function(){var e=this,t,s=V(this),n=this.checkboxGroupContext,r=this.$attrs,o=_e(this),i=s.indeterminate,c=s.prefixCls,u=te(s,["indeterminate","prefixCls"]),d=this.configProvider.getPrefixCls,h=d("checkbox",c),g=r.onMouseenter,p=g===void 0?se:g,y=r.onMouseleave,S=y===void 0?se:y;r.onInput;var D=r.class,_=r.style,M=te(r,["onMouseenter","onMouseleave","onInput","class","style"]),m=v(v(v({},u),{prefixCls:h}),M);n?(m.onChange=function(){for(var x=arguments.length,z=new Array(x),j=0;j<x;j++)z[j]=arguments[j];e.$emit.apply(e,["change"].concat(z)),n.toggleOption({label:o,value:s.value})},m.name=n.name,m.checked=n.sValue.indexOf(s.value)!==-1,m.disabled=s.disabled||n.disabled,m.indeterminate=i):m.onChange=this.handleChange;var T=U((t={},w(t,"".concat(h,"-wrapper"),!0),w(t,"".concat(h,"-wrapper-checked"),m.checked),w(t,"".concat(h,"-wrapper-disabled"),m.disabled),t),D),O=U(w({},"".concat(h,"-indeterminate"),i));return I("label",{class:T,style:_,onMouseenter:p,onMouseleave:S},[I(Je,Y(Y({},m),{},{class:O,ref:"vcCheckbox"}),null),o.length?I("span",null,[o]):null])}});const Qe=a=>Object.keys(a).length===0,W=(a,e)=>a.push.apply(a,e),et=(a,e)=>a.split("").map(s=>e[s]||s).join(""),A=a=>a.sort((e,t)=>e.i-t.i||e.j-t.j),ne=a=>{const e={};let t=1;return a.forEach(s=>{e[s]=t,t+=1}),e};var tt={4:[[1,2],[2,3]],5:[[1,3],[2,3]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]};const ae=2050,re=1e3,st=tt,nt=10,at=1e4,ue=10,he=50,fe=20,de=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,rt=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,ot=/^[A-Z\xbf-\xdf]+$/,ge=/^[^a-z\xdf-\xff]+$/,it=/^[a-z\xdf-\xff]+$/,ct=/^[^A-Z\xbf-\xdf]+$/,lt=/[a-z\xdf-\xff]/,ut=/[A-Z\xbf-\xdf]/,ht=/[^A-Za-z\xbf-\xdf]/gi,ft=/^\d+$/,q=new Date().getFullYear(),dt={recentYear:/19\d\d|200\d|201\d|202\d/g};class gt{match({password:e}){const t=[...this.getMatchesWithoutSeparator(e),...this.getMatchesWithSeparator(e)],s=this.filterNoise(t);return A(s)}getMatchesWithSeparator(e){const t=[],s=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/;for(let n=0;n<=Math.abs(e.length-6);n+=1)for(let r=n+5;r<=n+9&&!(r>=e.length);r+=1){const o=e.slice(n,+r+1||9e9),i=s.exec(o);if(i!=null){const c=this.mapIntegersToDayMonthYear([parseInt(i[1],10),parseInt(i[3],10),parseInt(i[4],10)]);c!=null&&t.push({pattern:"date",token:o,i:n,j:r,separator:i[2],year:c.year,month:c.month,day:c.day})}}return t}getMatchesWithoutSeparator(e){const t=[],s=/^\d{4,8}$/,n=r=>Math.abs(r.year-q);for(let r=0;r<=Math.abs(e.length-4);r+=1)for(let o=r+3;o<=r+7&&!(o>=e.length);o+=1){const i=e.slice(r,+o+1||9e9);if(s.exec(i)){const c=[],u=i.length;if(st[u].forEach(([h,g])=>{const p=this.mapIntegersToDayMonthYear([parseInt(i.slice(0,h),10),parseInt(i.slice(h,g),10),parseInt(i.slice(g),10)]);p!=null&&c.push(p)}),c.length>0){let h=c[0],g=n(c[0]);c.slice(1).forEach(p=>{const y=n(p);y<g&&(h=p,g=y)}),t.push({pattern:"date",token:i,i:r,j:o,separator:"",year:h.year,month:h.month,day:h.day})}}}return t}filterNoise(e){return e.filter(t=>{let s=!1;const n=e.length;for(let r=0;r<n;r+=1){const o=e[r];if(t!==o&&o.i<=t.i&&o.j>=t.j){s=!0;break}}return!s})}mapIntegersToDayMonthYear(e){if(e[1]>31||e[1]<=0)return null;let t=0,s=0,n=0;for(let r=0,o=e.length;r<o;r+=1){const i=e[r];if(i>99&&i<re||i>ae)return null;i>31&&(s+=1),i>12&&(t+=1),i<=0&&(n+=1)}return s>=2||t===3||n>=2?null:this.getDayMonth(e)}getDayMonth(e){const t=[[e[2],e.slice(0,2)],[e[0],e.slice(1,3)]],s=t.length;for(let n=0;n<s;n+=1){const[r,o]=t[n];if(re<=r&&r<=ae){const i=this.mapIntegersToDayMonth(o);return i!=null?{year:r,month:i.month,day:i.day}:null}}for(let n=0;n<s;n+=1){const[r,o]=t[n],i=this.mapIntegersToDayMonth(o);if(i!=null)return{year:this.twoToFourDigitYear(r),month:i.month,day:i.day}}return null}mapIntegersToDayMonth(e){const t=[e,e.slice().reverse()];for(let s=0;s<t.length;s+=1){const n=t[s],r=n[0],o=n[1];if(r>=1&&r<=31&&o>=1&&o<=12)return{day:r,month:o}}return null}twoToFourDigitYear(e){return e>99?e:e>50?e+1900:e+2e3}}var pt={a:["4","@"],b:["8"],c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]},N={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}};class mt{constructor(){this.matchers={},this.l33tTable=pt,this.dictionary={userInputs:[]},this.rankedDictionaries={},this.translations=N,this.graphs={},this.availableGraphs=[],this.setRankedDictionaries()}setOptions(e={}){e.l33tTable&&(this.l33tTable=e.l33tTable),e.dictionary&&(this.dictionary=e.dictionary,this.setRankedDictionaries()),e.translations&&this.setTranslations(e.translations),e.graphs&&(this.graphs=e.graphs)}setTranslations(e){if(this.checkCustomTranslations(e))this.translations=e;else throw new Error("Invalid translations object fallback to keys")}checkCustomTranslations(e){let t=!0;return Object.keys(N).forEach(s=>{if(s in e){const n=s;Object.keys(N[n]).forEach(r=>{r in e[n]||(t=!1)})}else t=!1}),t}setRankedDictionaries(){const e={};Object.keys(this.dictionary).forEach(t=>{e[t]=this.getRankedDictionary(t)}),this.rankedDictionaries=e}getRankedDictionary(e){const t=this.dictionary[e];if(e==="userInputs"){const s=[];return t.forEach(n=>{const r=typeof n;(r==="string"||r==="number"||r==="boolean")&&s.push(n.toString().toLowerCase())}),ne(s)}return ne(t)}extendUserInputsDictionary(e){this.dictionary.userInputs?this.dictionary.userInputs=[...this.dictionary.userInputs,...e]:this.dictionary.userInputs=e,this.rankedDictionaries.userInputs=this.getRankedDictionary("userInputs")}addMatcher(e,t){this.matchers[e]?console.info("Matcher already exists"):this.matchers[e]=t}}var l=new mt;class bt{constructor(e){this.defaultMatch=e}match({password:e}){const t=e.split("").reverse().join("");return this.defaultMatch({password:t}).map(s=>C(k({},s),{token:s.token.split("").reverse().join(""),reversed:!0,i:e.length-1-s.j,j:e.length-1-s.i}))}}class yt{constructor(e){this.defaultMatch=e}match({password:e}){const t=[],s=this.enumerateL33tSubs(this.relevantL33tSubtable(e,l.l33tTable));for(let n=0;n<s.length;n+=1){const r=s[n];if(Qe(r))break;const o=et(e,r);this.defaultMatch({password:o}).forEach(c=>{const u=e.slice(c.i,+c.j+1||9e9);if(u.toLowerCase()!==c.matchedWord){const d={};Object.keys(r).forEach(g=>{const p=r[g];u.indexOf(g)!==-1&&(d[g]=p)});const h=Object.keys(d).map(g=>`${g} -> ${d[g]}`).join(", ");t.push(C(k({},c),{l33t:!0,token:u,sub:d,subDisplay:h}))}})}return t.filter(n=>n.token.length>1)}relevantL33tSubtable(e,t){const s={},n={};return e.split("").forEach(r=>{s[r]=!0}),Object.keys(t).forEach(r=>{const i=t[r].filter(c=>c in s);i.length>0&&(n[r]=i)}),n}enumerateL33tSubs(e){const t=Object.keys(e);return this.getSubs(t,[[]],e).map(n=>{const r={};return n.forEach(([o,i])=>{r[o]=i}),r})}getSubs(e,t,s){if(!e.length)return t;const n=e[0],r=e.slice(1),o=[];s[n].forEach(c=>{t.forEach(u=>{let d=-1;for(let h=0;h<u.length;h+=1)if(u[h][0]===c){d=h;break}if(d===-1){const h=u.concat([[c,n]]);o.push(h)}else{const h=u.slice(0);h.splice(d,1),h.push([c,n]),o.push(u),o.push(h)}})});const i=this.dedup(o);return r.length?this.getSubs(r,i,s):i}dedup(e){const t=[],s={};return e.forEach(n=>{const r=n.map((i,c)=>[i,c]);r.sort();const o=r.map(([i,c])=>`${i},${c}`).join("-");o in s||(s[o]=!0,t.push(n))}),t}}class kt{constructor(){this.l33t=new yt(this.defaultMatch),this.reverse=new bt(this.defaultMatch)}match({password:e}){const t=[...this.defaultMatch({password:e}),...this.reverse.match({password:e}),...this.l33t.match({password:e})];return A(t)}defaultMatch({password:e}){const t=[],s=e.length,n=e.toLowerCase();return Object.keys(l.rankedDictionaries).forEach(r=>{const o=l.rankedDictionaries[r];for(let i=0;i<s;i+=1)for(let c=i;c<s;c+=1)if(n.slice(i,+c+1||9e9)in o){const u=n.slice(i,+c+1||9e9),d=o[u];t.push({pattern:"dictionary",i,j:c,token:e.slice(i,+c+1||9e9),matchedWord:u,rank:d,dictionaryName:r,reversed:!1,l33t:!1})}}),t}}class vt{match({password:e,regexes:t=dt}){const s=[];return Object.keys(t).forEach(n=>{const r=t[n];r.lastIndex=0;const o=r.exec(e);if(o){const i=o[0];s.push({pattern:"regex",token:i,i:o.index,j:o.index+o[0].length-1,regexName:n,regexMatch:o})}}),A(s)}}var E={nCk(a,e){let t=a;if(e>t)return 0;if(e===0)return 1;let s=1;for(let n=1;n<=e;n+=1)s*=t,s/=n,t-=1;return s},log10(a){return Math.log(a)/Math.log(10)},log2(a){return Math.log(a)/Math.log(2)},factorial(a){let e=1;for(let t=2;t<=a;t+=1)e*=t;return e}},Mt=({token:a})=>{let e=P(nt,a.length);e===Number.POSITIVE_INFINITY&&(e=Number.MAX_VALUE);let t;return a.length===1?t=ue+1:t=he+1,Math.max(e,t)},xt=({year:a,separator:e})=>{let s=Math.max(Math.abs(a-q),fe)*365;return e&&(s*=4),s};const Ct=a=>{const e=a.split(""),t=e.filter(o=>o.match(lt)).length,s=e.filter(o=>o.match(ut)).length;let n=0;const r=Math.min(t,s);for(let o=1;o<=r;o+=1)n+=E.nCk(t+s,o);return n};var Et=a=>{const e=a.replace(ht,"");if(e.match(ct)||e.toLowerCase()===e)return 1;const t=[de,rt,ge],s=t.length;for(let n=0;n<s;n+=1){const r=t[n];if(e.match(r))return 2}return Ct(e)};const St=({subs:a,subbed:e,token:t})=>{const s=a[e],n=t.toLowerCase().split(""),r=n.filter(i=>i===e).length,o=n.filter(i=>i===s).length;return{subbedCount:r,unsubbedCount:o}};var Tt=({l33t:a,sub:e,token:t})=>{if(!a)return 1;let s=1;const n=e;return Object.keys(n).forEach(r=>{const{subbedCount:o,unsubbedCount:i}=St({subs:n,subbed:r,token:t});if(o===0||i===0)s*=2;else{const c=Math.min(i,o);let u=0;for(let d=1;d<=c;d+=1)u+=E.nCk(i+o,d);s*=u}}),s},wt=({rank:a,reversed:e,l33t:t,sub:s,token:n})=>{const r=a,o=Et(n),i=Tt({l33t:t,sub:s,token:n}),c=e&&2||1,u=r*o*i*c;return{baseGuesses:r,uppercaseVariations:o,l33tVariations:i,calculation:u}},It=({regexName:a,regexMatch:e,token:t})=>{const s={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};if(a in s)return P(s[a],t.length);switch(a){case"recentYear":return Math.max(Math.abs(parseInt(e[0],10)-q),fe)}return 0},At=({baseGuesses:a,repeatCount:e})=>a*e,Dt=({token:a,ascending:e})=>{const t=a.charAt(0);let s=0;return["a","A","z","Z","0","1","9"].includes(t)?s=4:t.match(/\d/)?s=10:s=26,e||(s*=2),s*a.length};const _t=a=>{let e=0;return Object.keys(a).forEach(t=>{e+=a[t].filter(n=>!!n).length}),e/=Object.entries(a).length,e},Pt=({token:a,graph:e,turns:t})=>{const s=Object.keys(l.graphs[e]).length,n=_t(l.graphs[e]);let r=0;const o=a.length;for(let i=2;i<=o;i+=1){const c=Math.min(t,i-1);for(let u=1;u<=c;u+=1)r+=E.nCk(i-1,u-1)*s*P(n,u)}return r};var Ot=({graph:a,token:e,shiftedCount:t,turns:s})=>{let n=Pt({token:e,graph:a,turns:s});if(t){const r=e.length-t;if(t===0||r===0)n*=2;else{let o=0;for(let i=1;i<=Math.min(t,r);i+=1)o+=E.nCk(t+r,i);n*=o}}return Math.round(n)};const jt=(a,e)=>{let t=1;return a.token.length<e.length&&(a.token.length===1?t=ue:t=he),t},oe={bruteforce:Mt,date:xt,dictionary:wt,regex:It,repeat:At,sequence:Dt,spatial:Ot},$t=(a,e)=>oe[a]?oe[a](e):l.matchers[a]&&"scoring"in l.matchers[a]?l.matchers[a].scoring(e):0;var Rt=(a,e)=>{const t={};if("guesses"in a&&a.guesses!=null)return a;const s=jt(a,e),n=$t(a.pattern,a);let r=0;typeof n=="number"?r=n:a.pattern==="dictionary"&&(r=n.calculation,t.baseGuesses=n.baseGuesses,t.uppercaseVariations=n.uppercaseVariations,t.l33tVariations=n.l33tVariations);const o=Math.max(r,s);return C(k(k({},a),t),{guesses:o,guessesLog10:E.log10(o)})};const b={password:"",optimal:{},excludeAdditive:!1,fillArray(a,e){const t=[];for(let s=0;s<a;s+=1){let n=[];e==="object"&&(n={}),t.push(n)}return t},makeBruteforceMatch(a,e){return{pattern:"bruteforce",token:this.password.slice(a,+e+1||9e9),i:a,j:e}},update(a,e){const t=a.j,s=Rt(a,this.password);let n=s.guesses;e>1&&(n*=this.optimal.pi[s.i-1][e-1]);let r=E.factorial(e)*n;this.excludeAdditive||(r+=P(at,e-1));let o=!1;Object.keys(this.optimal.g[t]).forEach(i=>{const c=this.optimal.g[t][i];parseInt(i,10)<=e&&c<=r&&(o=!0)}),o||(this.optimal.g[t][e]=r,this.optimal.m[t][e]=s,this.optimal.pi[t][e]=n)},bruteforceUpdate(a){let e=this.makeBruteforceMatch(0,a);this.update(e,1);for(let t=1;t<=a;t+=1){e=this.makeBruteforceMatch(t,a);const s=this.optimal.m[t-1];Object.keys(s).forEach(n=>{s[n].pattern!=="bruteforce"&&this.update(e,parseInt(n,10)+1)})}},unwind(a){const e=[];let t=a-1,s=0,n=1/0;const r=this.optimal.g[t];for(r&&Object.keys(r).forEach(o=>{const i=r[o];i<n&&(s=parseInt(o,10),n=i)});t>=0;){const o=this.optimal.m[t][s];e.unshift(o),t=o.i-1,s-=1}return e}};var F={mostGuessableMatchSequence(a,e,t=!1){b.password=a,b.excludeAdditive=t;const s=a.length;let n=b.fillArray(s,"array");e.forEach(c=>{n[c.j].push(c)}),n=n.map(c=>c.sort((u,d)=>u.i-d.i)),b.optimal={m:b.fillArray(s,"object"),pi:b.fillArray(s,"object"),g:b.fillArray(s,"object")};for(let c=0;c<s;c+=1)n[c].forEach(u=>{u.i>0?Object.keys(b.optimal.m[u.i-1]).forEach(d=>{b.update(u,parseInt(d,10)+1)}):b.update(u,1)}),b.bruteforceUpdate(c);const r=b.unwind(s),o=r.length,i=this.getGuesses(a,o);return{password:a,guesses:i,guessesLog10:E.log10(i),sequence:r}},getGuesses(a,e){const t=a.length;let s=0;return a.length===0?s=1:s=b.optimal.g[t-1][e],s}};class Lt{match({password:e,omniMatch:t}){const s=[];let n=0;for(;n<e.length;){const o=this.getGreedyMatch(e,n),i=this.getLazyMatch(e,n);if(o==null)break;const{match:c,baseToken:u}=this.setMatchToken(o,i);if(c){const d=c.index+c[0].length-1,h=this.getBaseGuesses(u,t);s.push(this.normalizeMatch(u,d,c,h)),n=d+1}}return s.some(o=>o instanceof Promise)?Promise.all(s):s}normalizeMatch(e,t,s,n){const r={pattern:"repeat",i:s.index,j:t,token:s[0],baseToken:e,baseGuesses:0,repeatCount:s[0].length/e.length};return n instanceof Promise?n.then(o=>C(k({},r),{baseGuesses:o})):C(k({},r),{baseGuesses:n})}getGreedyMatch(e,t){const s=/(.+)\1+/g;return s.lastIndex=t,s.exec(e)}getLazyMatch(e,t){const s=/(.+?)\1+/g;return s.lastIndex=t,s.exec(e)}setMatchToken(e,t){const s=/^(.+?)\1+$/;let n,r="";if(t&&e[0].length>t[0].length){n=e;const o=s.exec(n[0]);o&&(r=o[1])}else n=t,n&&(r=n[1]);return{match:n,baseToken:r}}getBaseGuesses(e,t){const s=t.match(e);return s instanceof Promise?s.then(r=>F.mostGuessableMatchSequence(e,r).guesses):F.mostGuessableMatchSequence(e,s).guesses}}class Nt{constructor(){this.MAX_DELTA=5}match({password:e}){const t=[];if(e.length===1)return[];let s=0,n=null;const r=e.length;for(let o=1;o<r;o+=1){const i=e.charCodeAt(o)-e.charCodeAt(o-1);if(n==null&&(n=i),i!==n){const c=o-1;this.update({i:s,j:c,delta:n,password:e,result:t}),s=c,n=i}}return this.update({i:s,j:r-1,delta:n,password:e,result:t}),t}update({i:e,j:t,delta:s,password:n,result:r}){if(t-e>1||Math.abs(s)===1){const o=Math.abs(s);if(o>0&&o<=this.MAX_DELTA){const i=n.slice(e,+t+1||9e9),{sequenceName:c,sequenceSpace:u}=this.getSequence(i);return r.push({pattern:"sequence",i:e,j:t,token:n.slice(e,+t+1||9e9),sequenceName:c,sequenceSpace:u,ascending:s>0})}}return null}getSequence(e){let t="unicode",s=26;return it.test(e)?(t="lower",s=26):ot.test(e)?(t="upper",s=26):ft.test(e)&&(t="digits",s=10),{sequenceName:t,sequenceSpace:s}}}class Gt{constructor(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}match({password:e}){const t=[];return Object.keys(l.graphs).forEach(s=>{const n=l.graphs[s];W(t,this.helper(e,n,s))}),A(t)}checkIfShifted(e,t,s){return!e.includes("keypad")&&this.SHIFTED_RX.test(t.charAt(s))?1:0}helper(e,t,s){let n;const r=[];let o=0;const i=e.length;for(;o<i-1;){let c=o+1,u=0,d=0;for(n=this.checkIfShifted(s,e,o);;){const h=e.charAt(c-1),g=t[h]||[];let p=!1,y=-1,S=-1;if(c<i){const D=e.charAt(c),_=g.length;for(let M=0;M<_;M+=1){const m=g[M];if(S+=1,m){const T=m.indexOf(D);if(T!==-1){p=!0,y=S,T===1&&(n+=1),u!==y&&(d+=1,u=y);break}}}}if(p)c+=1;else{c-o>2&&r.push({pattern:"spatial",i:o,j:c-1,token:e.slice(o,c),graph:s,turns:d,shiftedCount:n}),o=c;break}}}return r}}class Bt{constructor(){this.matchers={date:gt,dictionary:kt,regex:vt,repeat:Lt,sequence:Nt,spatial:Gt}}match(e){const t=[],s=[];return[...Object.keys(this.matchers),...Object.keys(l.matchers)].forEach(r=>{if(!this.matchers[r]&&!l.matchers[r])return;const o=this.matchers[r]?this.matchers[r]:l.matchers[r].Matching,c=new o().match({password:e,omniMatch:this});c instanceof Promise?(c.then(u=>{W(t,u)}),s.push(c)):W(t,c)}),s.length>0?new Promise(r=>{Promise.all(s).then(()=>{r(A(t))})}):A(t)}}const pe=1,me=pe*60,be=me*60,ye=be*24,ke=ye*31,ve=ke*12,Vt=ve*100,G={second:pe,minute:me,hour:be,day:ye,month:ke,year:ve,century:Vt};class Ut{translate(e,t){let s=e;t!==void 0&&t!==1&&(s+="s");const{timeEstimation:n}=l.translations;return n[s].replace("{base}",`${t}`)}estimateAttackTimes(e){const t={onlineThrottling100PerHour:e/.027777777777777776,onlineNoThrottling10PerSecond:e/10,offlineSlowHashing1e4PerSecond:e/1e4,offlineFastHashing1e10PerSecond:e/1e10},s={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(t).forEach(n=>{const r=t[n];s[n]=this.displayTime(r)}),{crackTimesSeconds:t,crackTimesDisplay:s,score:this.guessesToScore(e)}}guessesToScore(e){return e<1e3+5?0:e<1e6+5?1:e<1e8+5?2:e<1e10+5?3:4}displayTime(e){let t="centuries",s;const n=Object.keys(G),r=n.findIndex(o=>e<G[o]);return r>-1&&(t=n[r-1],r!==0?s=Math.round(e/G[t]):t="ltSecond"),this.translate(t,s)}}var Yt=()=>null,Wt=()=>({warning:l.translations.warnings.dates,suggestions:[l.translations.suggestions.dates]});const Ft=(a,e)=>{let t="";return e&&!a.l33t&&!a.reversed?a.rank<=10?t=l.translations.warnings.topTen:a.rank<=100?t=l.translations.warnings.topHundred:t=l.translations.warnings.common:a.guessesLog10<=4&&(t=l.translations.warnings.similarToCommon),t},Ht=(a,e)=>{let t="";return e&&(t=l.translations.warnings.wordByItself),t},qt=(a,e)=>e?l.translations.warnings.namesByThemselves:l.translations.warnings.commonNames,zt=(a,e)=>{let t="";const s=a.dictionaryName,n=s==="lastnames"||s.toLowerCase().includes("firstnames");return s==="passwords"?t=Ft(a,e):s.includes("wikipedia")?t=Ht(a,e):n?t=qt(a,e):s==="userInputs"&&(t=l.translations.warnings.userInputs),t};var Kt=(a,e)=>{const t=zt(a,e),s=[],n=a.token;return n.match(de)?s.push(l.translations.suggestions.capitalization):n.match(ge)&&n.toLowerCase()!==n&&s.push(l.translations.suggestions.allUppercase),a.reversed&&a.token.length>=4&&s.push(l.translations.suggestions.reverseWords),a.l33t&&s.push(l.translations.suggestions.l33t),{warning:t,suggestions:s}},Zt=a=>a.regexName==="recentYear"?{warning:l.translations.warnings.recentYears,suggestions:[l.translations.suggestions.recentYears,l.translations.suggestions.associatedYears]}:{warning:"",suggestions:[]},Xt=a=>{let e=l.translations.warnings.extendedRepeat;return a.baseToken.length===1&&(e=l.translations.warnings.simpleRepeat),{warning:e,suggestions:[l.translations.suggestions.repeated]}},Jt=()=>({warning:l.translations.warnings.sequences,suggestions:[l.translations.suggestions.sequences]}),Qt=a=>{let e=l.translations.warnings.keyPattern;return a.turns===1&&(e=l.translations.warnings.straightRow),{warning:e,suggestions:[l.translations.suggestions.longerKeyboardPattern]}};const ie={warning:"",suggestions:[]};class es{constructor(){this.matchers={bruteforce:Yt,date:Wt,dictionary:Kt,regex:Zt,repeat:Xt,sequence:Jt,spatial:Qt},this.defaultFeedback={warning:"",suggestions:[]},this.setDefaultSuggestions()}setDefaultSuggestions(){this.defaultFeedback.suggestions.push(l.translations.suggestions.useWords,l.translations.suggestions.noNeed)}getFeedback(e,t){if(t.length===0)return this.defaultFeedback;if(e>2)return ie;const s=l.translations.suggestions.anotherWord,n=this.getLongestMatch(t);let r=this.getMatchFeedback(n,t.length===1);return r!=null?(r.suggestions.unshift(s),r.warning==null&&(r.warning="")):r={warning:"",suggestions:[s]},r}getLongestMatch(e){let t=e[0];return e.slice(1).forEach(n=>{n.token.length>t.token.length&&(t=n)}),t}getMatchFeedback(e,t){return this.matchers[e.pattern]?this.matchers[e.pattern](e,t):l.matchers[e.pattern]&&"feedback"in l.matchers[e.pattern]?l.matchers[e.pattern].feedback(e,t):ie}}const Me=()=>new Date().getTime(),ce=(a,e,t)=>{const s=new es,n=new Ut,r=F.mostGuessableMatchSequence(e,a),o=Me()-t,i=n.estimateAttackTimes(r.guesses);return C(k(k({calcTime:o},r),i),{feedback:s.getFeedback(i.score,r.sequence)})},ts=(a,e)=>{e&&l.extendUserInputsDictionary(e);const t=new Bt,s=Me(),n=t.match(a);return n instanceof Promise?n.then(r=>ce(r,a,s)):ce(n,a,s)};const ss=H({name:"StrengthMeter",components:{InputPassword:Pe.Password},props:{value:$.string,showInput:$.bool.def(!0),disabled:$.bool},emits:["score-change","change"],setup(a,{emit:e}){const t=Oe(""),{prefixCls:s}=je("strength-meter"),n=$e(()=>{const{disabled:o}=a;if(o)return-1;const c=R(t)?ts(R(t)).score:-1;return e("score-change",c),c});function r(o){t.value=o.target.value}return Re(()=>{t.value=a.value||""}),Le(()=>R(t),o=>{e("change",o)}),{getPasswordStrength:n,handleChange:r,prefixCls:s,innerValueRef:t}}}),ns=["data-score"];function as(a,e,t,s,n,r){const o=Ge("InputPassword");return Q(),Be("div",{class:L([a.prefixCls,"relative"])},[a.showInput?(Q(),Ve(o,ze({key:0},a.$attrs,{allowClear:"",value:a.innerValueRef,onChange:a.handleChange,disabled:a.disabled}),Ue({_:2},[Ye(Object.keys(a.$slots),i=>({name:i,fn:We(c=>[Fe(a.$slots,i,He(qe(c||{})),void 0,!0)])}))]),1040,["value","onChange","disabled"])):Ke("",!0),ee("div",{class:L(`${a.prefixCls}-bar`)},[ee("div",{class:L(`${a.prefixCls}-bar--fill`),"data-score":a.getPasswordStrength},null,10,ns)],2)],2)}var rs=Ne(ss,[["render",as],["__scopeId","data-v-3bfd49a1"]]);const ls=Ze(rs);export{cs as C,ls as S,Je as a};
